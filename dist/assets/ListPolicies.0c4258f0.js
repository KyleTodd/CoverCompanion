import{S as we,i as ye,s as ke,e as n,a as $,A as x,t as y,b as t,W as Te,h as de,c as re,d as e,C as ee,m as oe,p as Pe,v as z,G as N,D as De,F as $e,E as F,f as ce,H as te,U as Ce,r as Le,g as Se,q as Ae,x as Me,y as fe}from"./index.28ceac01.js";import{I as le}from"./Icon.9347ffee.js";import{g as he,i as ie}from"./policyTypes.f03c44ef.js";function pe(l,a,s){const u=l.slice();return u[11]=a[s],u}function be(l){let a,s,u,o=l[11].S_DATE+"",_,i,d;return s=new le({props:{inline:!0,icon:"material-symbols:edit-calendar",color:"white"}}),{c(){a=n("div"),x(s.$$.fragment),u=y(" Start date: "),_=y(o),i=y(" - 4:00pm"),t(a,"class","date datebg-green")},m(p,S){re(p,a,S),ee(s,a,null),e(a,u),e(a,_),e(a,i),d=!0},p(p,S){(!d||S&4)&&o!==(o=p[11].S_DATE+"")&&z(_,o)},i(p){d||(N(s.$$.fragment,p),d=!0)},o(p){F(s.$$.fragment,p),d=!1},d(p){p&&ce(a),te(s)}}}function ve(l){let a,s,u=l[11].daysUntilExpiry+"",o,_;return{c(){a=n("div"),s=y("Expiring in "),o=y(u),_=y(" days"),t(a,"class","date datebg-orange")},m(i,d){re(i,a,d),e(a,s),e(a,o),e(a,_)},p(i,d){d&4&&u!==(u=i[11].daysUntilExpiry+"")&&z(o,u)},d(i){i&&ce(a)}}}function _e(l){let a,s,u,o,_,i,d,p=l[11].DESCRIPTION+"",S,D,I,C,A=he(l[11].TYPE)+"",c,O,U=l[11].POLICY_NUMBER+"",g,M,m,Y,b,k,G,V=l[11].E_DATE+"",X,J,R,j,H,B,ae,q,T,W,ne;o=new le({props:{icon:ie[l[11].TYPE]||ie.default,color:"black",width:"3.5em",height:"3.5em"}});let f=l[11].futureStartDate&&be(l);k=new le({props:{inline:!0,icon:"material-symbols:calendar-month",color:"white"}});let E=l[11].daysUntilExpiry&&ve(l);B=new le({props:{icon:"material-symbols:search",color:"white",width:"30",height:"30"}});function Z(){return l[9](l[11])}return{c(){a=n("div"),s=n("div"),u=n("div"),x(o.$$.fragment),_=$(),i=n("div"),d=n("h5"),S=y(p),D=$(),I=n("p"),C=n("b"),c=y(A),O=y(" - "),g=y(U),M=$(),m=n("div"),f&&f.c(),Y=$(),b=n("div"),x(k.$$.fragment),G=$(),X=y(V),J=$(),E&&E.c(),R=$(),j=n("div"),H=n("button"),x(B.$$.fragment),ae=y(" View Policy"),q=$(),t(u,"class","col-sm-1 col-md-1 col-2 d-flex justify-content-center align-items-center"),t(d,"class","policy-desc"),t(I,"class","card-subtitle text-muted"),t(i,"class","col-md-4 col-10 d-flex flex-column justify-content-center align-items-start"),t(b,"class","date datebg-dark"),t(m,"class","col-md-4 col-12 d-flex flex-column align-items-center align-items-sm-start align-self-center align-self-md-start p-2"),t(H,"class","btn btn-dark"),de(H,"height","2.5em"),t(j,"class","justify-content-sm-end justify-content-center col-md-3 col-12 d-flex align-self-md-center "),t(s,"class","card-body row "),t(a,"class","card border-1 shadow mb-3")},m(w,L){re(w,a,L),e(a,s),e(s,u),ee(o,u,null),e(s,_),e(s,i),e(i,d),e(d,S),e(i,D),e(i,I),e(I,C),e(C,c),e(I,O),e(I,g),e(s,M),e(s,m),f&&f.m(m,null),e(m,Y),e(m,b),ee(k,b,null),e(b,G),e(b,X),e(m,J),E&&E.m(m,null),e(s,R),e(s,j),e(j,H),ee(B,H,null),e(H,ae),e(a,q),T=!0,W||(ne=oe(H,"click",Z),W=!0)},p(w,L){l=w;const se={};L&4&&(se.icon=ie[l[11].TYPE]||ie.default),o.$set(se),(!T||L&4)&&p!==(p=l[11].DESCRIPTION+"")&&z(S,p),(!T||L&4)&&A!==(A=he(l[11].TYPE)+"")&&z(c,A),(!T||L&4)&&U!==(U=l[11].POLICY_NUMBER+"")&&z(g,U),l[11].futureStartDate?f?(f.p(l,L),L&4&&N(f,1)):(f=be(l),f.c(),N(f,1),f.m(m,Y)):f&&(De(),F(f,1,1,()=>{f=null}),$e()),(!T||L&4)&&V!==(V=l[11].E_DATE+"")&&z(X,V),l[11].daysUntilExpiry?E?E.p(l,L):(E=ve(l),E.c(),E.m(m,null)):E&&(E.d(1),E=null)},i(w){T||(N(o.$$.fragment,w),N(f),N(k.$$.fragment,w),N(B.$$.fragment,w),T=!0)},o(w){F(o.$$.fragment,w),F(f),F(k.$$.fragment,w),F(B.$$.fragment,w),T=!1},d(w){w&&ce(a),te(o),f&&f.d(),te(k),E&&E.d(),te(B),W=!1,ne()}}}function Ne(l){let a,s,u,o,_,i,d,p,S,D,I,C,A,c,O,U,g,M,m,Y,b,k,G,V,X,J,R,j,H,B,ae,q,T,W,ne,f,E,Z=l[2].length+"",w,L,se,K,ue,ge;k=new le({props:{icon:"ion:person-sharp",color:"white",width:"20",height:"20"}}),j=new le({props:{icon:"material-symbols:logout",color:"red",width:"20",height:"20"}});let Q=l[2],h=[];for(let r=0;r<Q.length;r+=1)h[r]=_e(pe(l,Q,r));const Ee=r=>F(h[r],1,1,()=>{h[r]=null});return{c(){a=n("html"),s=n("head"),s.innerHTML="<style></style>",u=$(),o=n("body"),_=n("nav"),i=n("div"),d=n("img"),S=$(),D=n("button"),D.innerHTML='<span class="navbar-toggler-icon"></span>',I=$(),C=n("div"),A=n("ul"),c=n("li"),c.innerHTML='<a class="nav-link active" href="#"><b>Current Policies</b></a>',O=$(),U=n("li"),g=n("a"),g.textContent="Expired Policies",M=$(),m=n("ul"),Y=n("li"),b=n("button"),x(k.$$.fragment),G=$(),V=y(l[0]),X=$(),J=n("li"),R=n("button"),x(j.$$.fragment),H=y(" Logout"),ae=$(),q=n("div"),T=n("div"),W=n("h1"),W.textContent="Current Policies",ne=$(),f=n("h5"),E=y("There are "),w=y(Z),L=y(" active policies on your account."),se=$();for(let r=0;r<h.length;r+=1)h[r].c();t(d,"class","navbar-brand"),Te(d.src,p="https://www.bespokeinsurancegroup.com.au/uploads/site_logo/site_logo.png")||t(d,"src",p),t(d,"alt","Bespoke Logo"),t(D,"class","navbar-toggler"),t(D,"type","button"),t(D,"data-bs-toggle","collapse"),t(D,"data-bs-target","#navbarNav"),t(D,"aria-controls","navbarNav"),t(D,"aria-expanded","false"),t(D,"aria-label","Toggle navigation"),t(c,"class","nav-item active"),t(g,"class","nav-link"),t(g,"href","#"),t(U,"class","nav-item"),t(A,"class","navbar-nav me-auto mb-2 mb-lg-0"),t(b,"class","btn btn-outline-light"),t(b,"href","#"),t(Y,"class","nav-item end-button"),t(R,"class","btn btn-outline-danger"),t(R,"href","#"),t(J,"class","nav-item end-button"),t(m,"class","navbar-nav ml-auto"),t(C,"class",B="navbar-collapse "+(l[3]?"":"collapse")),t(C,"id","navbarNav"),t(i,"class","container-fluid"),t(_,"class","navbar navbar-expand-lg bg-dark navbar-dark"),t(W,"style",""),de(f,"color","grey"),de(T,"padding-bottom","1em"),t(q,"class","container-fluid mt-4"),t(o,"class","body-bg"),t(a,"lang","en"),t(a,"class","body-dark")},m(r,P){re(r,a,P),e(a,s),e(a,u),e(a,o),e(o,_),e(_,i),e(i,d),e(i,S),e(i,D),e(i,I),e(i,C),e(C,A),e(A,c),e(A,O),e(A,U),e(U,g),e(C,M),e(C,m),e(m,Y),e(Y,b),ee(k,b,null),e(b,G),e(b,V),e(m,X),e(m,J),e(J,R),ee(j,R,null),e(R,H),e(o,ae),e(o,q),e(q,T),e(T,W),e(T,ne),e(T,f),e(f,E),e(f,w),e(f,L),e(q,se);for(let v=0;v<h.length;v+=1)h[v].m(q,null);K=!0,ue||(ge=[oe(D,"click",l[7]),oe(g,"click",Pe(l[8])),oe(R,"click",l[5])],ue=!0)},p(r,[P]){if((!K||P&1)&&z(V,r[0]),(!K||P&8&&B!==(B="navbar-collapse "+(r[3]?"":"collapse")))&&t(C,"class",B),(!K||P&4)&&Z!==(Z=r[2].length+"")&&z(w,Z),P&70){Q=r[2];let v;for(v=0;v<Q.length;v+=1){const me=pe(r,Q,v);h[v]?(h[v].p(me,P),N(h[v],1)):(h[v]=_e(me),h[v].c(),N(h[v],1),h[v].m(q,null))}for(De(),v=Q.length;v<h.length;v+=1)Ee(v);$e()}},i(r){if(!K){N(k.$$.fragment,r),N(j.$$.fragment,r);for(let P=0;P<Q.length;P+=1)N(h[P]);K=!0}},o(r){F(k.$$.fragment,r),F(j.$$.fragment,r),h=h.filter(Boolean);for(let P=0;P<h.length;P+=1)F(h[P]);K=!1},d(r){r&&ce(a),te(k),te(j),Ce(h,r),ue=!1,Le(ge)}}}function Ie(l,a,s){let u;Se(l,Me,c=>s(4,u=c));let o="",_="",i=[];function d(){fe.get("http://localhost:3000/logout",{withCredentials:!0}).then(c=>{c.status===200?(localStorage.removeItem("session"),console.log("Session Cleared"),u("/Login")):console.log("Logout failed with status: "+c.status)}).catch(c=>{console.error(c)})}Ae(async()=>{try{const c=await fe.get("http://localhost:3000/getUsername",{withCredentials:!0});s(0,o=c.data.email),s(1,_=c.data.username),console.log(c),o==null?(console.log("Not logged in"),u("/Login")):(console.log("Logged in "+o),S().catch(console.error))}catch(c){console.error(c)}});function p(c,O){u(`/Pdf?username=${c}&policyNumber=${O}`)}const S=async()=>{const c=await fe.get("http://localhost:3000/getPolicies",{withCredentials:!0});s(2,i=c.data);const O=new Date;s(2,i=i.filter(g=>{let M=new Date(g.S_DATE);g.S_DATE=`${("0"+M.getDate()).slice(-2)}/${("0"+(M.getMonth()+1)).slice(-2)}/${M.getFullYear()}`;let m=M.getTime()-O.getTime();Math.ceil(m/(1e3*3600*24))>0&&(g.futureStartDate=!0);let b=new Date(g.E_DATE);g.E_DATE=`${("0"+b.getDate()).slice(-2)}/${("0"+(b.getMonth()+1)).slice(-2)}/${b.getFullYear()}`;let k=b.getTime()-O.getTime(),G=Math.ceil(k/(1e3*3600*24));return G<=31&&(g.daysUntilExpiry=G),G>0}).sort((g,M)=>{let m=new Date(g.E_DATE.split("/").reverse().join("-")),Y=new Date(M.E_DATE.split("/").reverse().join("-"));return m-Y}));const U=i.map(g=>g.E_DATE);console.log(U)};let D=!1;function I(){s(3,D=!D)}return[o,_,i,D,u,d,p,I,()=>u("/ExpiredPolicies"),c=>p(_,c.POLICY_NUMBER)]}class Be extends we{constructor(a){super(),ye(this,a,Ie,Ne,ke,{})}}export{Be as default};
